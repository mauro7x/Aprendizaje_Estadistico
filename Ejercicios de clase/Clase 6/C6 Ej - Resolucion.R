# ------------------------------------------------------------------------------------------------------
# 3. Cafe.
# ------------------------------------------------------------------------------------------------------

# ------------------------------------------------------------------------------------------------------
# DATOS
df <- read.table(file="cafeina.txt", header = TRUE)
df <- df[,-1]
# ------------------------------------------------------------------------------------------------------


# ------------------------------------------------------------------------------------------------------

X <- cbind((c(rep(1,10), rep(0,20))), (c(rep(0,10), rep(1,10), rep(0,10))), (c(rep(0,20), rep(1,10))))
n <- 30
p <- 3
q <- 2

B_sombrero <- solve(t(X) %*% X) %*% t(X) %*% df$y
B_sombrero_2 <- c(mean(df$y[1:10]), mean(df$y[11:20]), mean(df$y[21:30]))

C <- cbind(c(1,0),c(-1, 1),c(0, -1))
S_2 <- (t(df$y - X%*%B_sombrero) %*% (df$y - X%*%B_sombrero))/(n-p)

estadistico <- (t(C %*% B_sombrero) %*% solve(C %*% solve(t(X) %*% X) %*% t(C)) %*% (C %*% B_sombrero)) / (q*S_2)

qf(0.975, q, n-p)
1 - pf(estadistico, q, n-p)

# ------------------------------------------------------------------------------------------------------
# BON FERRONI

# u1 - u2 = c1 (1 -1 0)
# u1 - u3 = c2 (1 0 -1)
# u2 - u3 = c3 (0 1 -1)
# q = 3

q <- 3
c1 <- c(1, -1, 0)
c2 <- c(1, 0, -1)
c3 <- c(0, 1, -1)

i1 <- c(t(c1)%*%B_sombrero - qt(1-(0.05/(2*q)), n-p)*sqrt(S_2*(t(c1)%*%solve(t(X)%*%X)%*%c1)),
        t(c1)%*%B_sombrero + qt(1-(0.05/(2*q)), n-p)*sqrt(S_2*(t(c1)%*%solve(t(X)%*%X)%*%c1)))

i2 <- c(t(c2)%*%B_sombrero - qt(1-(0.05/(2*q)), n-p)*sqrt(S_2*(t(c2)%*%solve(t(X)%*%X)%*%c2)),
        t(c2)%*%B_sombrero + qt(1-(0.05/(2*q)), n-p)*sqrt(S_2*(t(c2)%*%solve(t(X)%*%X)%*%c2)))

i3 <- c(t(c3)%*%B_sombrero - qt(1-(0.05/(2*q)), n-p)*sqrt(S_2*(t(c3)%*%solve(t(X)%*%X)%*%c3)),
        t(c3)%*%B_sombrero + qt(1-(0.05/(2*q)), n-p)*sqrt(S_2*(t(c3)%*%solve(t(X)%*%X)%*%c3)))


# u1 distinto de u3.

# ------------------------------------------------------------------------------------------------------







# ------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------




